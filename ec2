version: '3'
services:
  test-tif-apps:
    image: ${test_ECR_REPO}/test-tif-apps:${test_BUILD_TAG}
    container_name: test-tif-apps
    ports:
      - 80:80
    volumes:
      - ${test_CONTAINER}/logs/tifapps:/usr/local/tomcat/logs
      - ${test_CONTAINER}/servers/test-tif-apps:/usr/share/nginx/servers
    extra_hosts:
      - host.docker.internal:host-gateway
  test-rest:
    image: ${test_ECR_REPO}/test-rest-services:${test_BUILD_TAG}
    container_name: test-rest
    environment:
      - dbhost=${test_DB_HOST}
      - dbport=123
      - mqhost=host.docker.internal
      - mqport=123
      - tadb=${test_TA_DB_NAME}
      - tadbuser=${test_TA_USERNAME}
      - tadbpassword=${test_TA_PASSWORD}
      - nodename=test
      - debug=true
      - ssmregion=${SSMREGION}
      - ssmkeyprefix=${SSMKEYPREFIX}
      - test1sdecisionservicehost=${test1SDECISIONSERVICEHOST}
      - test1sdecisionmanagerhost=${test1SDECISIONMANAGERHOST}
    volumes:
      - ${test_CONTAINER}/logs/rest:/usr/local/tomcat/logs
      - ${test_testFS_FOLDER}:/usr/local/test
  test-ert:
    image: ${test_ECR_REPO}/test-rest-services:${test_BUILD_TAG}
    container_name: test-rest
    environment:
      - dbhost=${test_DB_HOST}
      - dbport=123
      - mqhost=host.docker.internal
      - mqport=123
      - tadb=${test_TA_DB_NAME}
      - tadbuser=${test_TA_USERNAME}
      - tadbpassword=${test_TA_PASSWORD}
      - nodename=test
      - debug=true
      - ssmregion=${SSMREGION}
      - ssmkeyprefix=${SSMKEYPREFIX}
      - test1sdecisionservicehost=${test1SDECISIONSERVICEHOST}
      - test1sdecisionmanagerhost=${test1SDECISIONMANAGERHOST}
    volumes:
      - ${test_CONTAINER}/logs/rest:/usr/local/tomcat/logs
      - ${test_testFS_FOLDER}:/usr/local/test
